<!DOCTYPE html>
<html lang="zh-Hant-TW">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>天地心，起厝情 傳承愛，慶功宴</title>

  <!-- 新增 favicon 設定 -->
  <link rel="icon" type="image/x-icon" href="https://www.greaten.com.tw/images/favicon.ico">
  <link rel="stylesheet" href="./style.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- 添加 Bootstrap Icons CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>

<body>
  <div id="loading">
    <!-- <div class="loader"></div> -->
    <span class="loader" src="./images/mvdlogo.webp" alt="Logo loading" width="100%">
    </span>
  </div>

  <header>
    <div class="header-container">
      <div class="logo">
        <a href="https://www.greaten.com.tw/" target="_blank">
          <img id="footer-logo" alt="Logo 1" class="desktop-text footer-logo-top">
          <img id="footer-logo2" alt="Logo 1" class="mobile-text footer-logo-top">
        </a>
      </div>
      <div class="nav-buttons">
        <button onclick="scrollToSection('intro-section')">起厝</button>
        <button onclick="scrollToSection('search-section')">座位查詢</button>
        <button onclick="scrollToSection('parking-info-section')">停車場</button>
      </div>
    </div>

  </header>

  <main>
    <section class="intro-section">
      <div class="intro-container">
        <div class="intro-title">
          <div class="intro-title-left"></div>
          <div class="intro-title-center">
            <h2>天地心，起厝情<br>傳承愛，慶功宴</h2>
          </div>
          <div class="intro-title-right"></div>
        </div>
        <p class="desktop-text">家，是一切的起點。<br>
          在這個充滿祝福與喜悦的時刻，我們誠挚地邀請您参加「桂田大樹」的家宴。<br>
          這次盛宴不僅是為了慶祝桂田大樹故事館的落成、《起厝》新書發行及<br>
          紀錄片微電影的首映，更是我們迎接朱家第一位孫千金誕生的幸福時刻。<br>
          這一切象徵著祝福與希望，讓我們的心更加緊密相連。<br>
          在企業經營的路上，您始終陪伴在側，您的支持與鼓勵是我們前行的動力。<br>
          回首來時路，您無疑是我們最珍貴的家人。<br>
          選擇在老家大社「桂田大樹」舉辦，原因無二，這裡是桂田與朱家擴展的源頭，<br>
          象徵不忘本、飲水思源的精神。<br>
          我們期待與您分享這份溫暖與榮耀，讓祝福在「家聚」的每個角落流淌。<br>
          吹拂輕柔晚風，就著清朗燈光，擺席田園農村，敬備台南道地國宴總舖師<br>
          阿舍辦桌菜及精彩節目，期待與您共度惠風和暢的溫馨家宴。<br>
        </p>
        <p class="mobile-text">
          家，是一切的起點。<br>
          在這個充滿祝福與喜悦的時刻，<br>
          我們誠挚地邀請您参加「桂田大樹」的家宴。<br>
          這次盛宴不僅是為了慶祝桂田大樹故事館的落成、<br>
          《起厝》新書發行及紀錄片微電影的首映，<br>
          更是我們迎接朱家第一位孫千金誕生的幸福時刻。<br>
          這一切象徵著祝福與希望，讓我們的心更加緊密相連。<br>
          在企業經營的路上，您始終陪伴在側，<br>
          您的支持與鼓勵是我們前行的動力。<br>
          回首來時路，您無疑是我們最珍貴的家人。<br>
          選擇在老家大社「桂田大樹」舉辦，原因無二，<br>
          這裡是桂田與朱家擴展的源頭，<br>
          象徵不忘本、飲水思源的精神。<br>
          我們期待與您分享這份溫暖與榮耀，<br>
          讓祝福在「家聚」的每個角落流淌。<br>
          吹拂輕柔晚風，就著清朗燈光，擺席田園農村，<br>
          敬備台南道地國宴總舖師阿舍辦桌菜及精彩節目，<br>
          期待與您共度惠風和暢的溫馨家宴。<br>
        </p>
        <h4 class="desktop-text" style="line-height: 1.5;">日期：114 年 3 月 21 日 (五) | 16:00-21:00<br>
          地點:桂田大樹 The Greatens (臺南市新市區大社里大社875之1號)<br>
          謹註:來賓請攜邀請函入場 (因場地空間限制，設有人数上限。)</h4>
        <h4 class="mobile-text" style="line-height: 1.5;">日期：114 年 3 月 21 日 (五) | 16:00-21:00<br>
          地點:桂田大樹 The Greatens<br>
          謹註:來賓請攜邀請函入場<br></h4>
        <h4 class="mobile-sign sign-text">桂田集團 董事長<img src="./images/sign.png" alt="空白圖片">敬邀</h4>
      </div>
    </section>

    <section class="search-section">
      <div class="search-container">
        <h1 class="desktop-text">座位查詢</h1>
        <h1 class="mobile-text">座位查詢</h1>
        <div class="input-container">
          <input type="text" id="nameInput" placeholder="請輸入姓名或是公司名稱">
          <i class="bi bi-search search-icon"></i>
        </div>
        <div class="search-result">
          <p id="search-result">
          </p>
        </div>
        <div id="image-container">
          <img id="result_with_circles" alt="空白圖片">
          <!-- <div class="area-A" style="border: 3px solid #ff0000; width: 140px; height: 89px; animation: homeBlink2 2s infinite ease-in-out;"></div>
          <div class="area-B" style="border: 3px solid #000000; width: 24px; height: 92px; animation: homeBlink2 2s infinite ease-in-out;"></div>
          <div class="area-C" style="border: 3px solid #000000; width: 24px; height: 99px; animation: homeBlink2 2s infinite ease-in-out;"></div>
          <div class="area-D" style="border: 3px solid #000000; width: 24px; height: 98px; animation: homeBlink2 2s infinite ease-in-out;"></div>
          <div class="area-E" style="border: 3px solid #000000; width: 24px; height: 94px; animation: homeBlink2 2s infinite ease-in-out;"></div> -->
        </div>
      </div>



    </section>
    <section class="parking-info-section">
      <div class="parking-info-container">
        <h1 class="desktop-text">貴賓您好，<br>我們有為您規劃停車場停車位置，<br>麻煩請先至座位查詢確認。</h1>
        <h1 class="mobile-text">貴賓您好，<br>我們有為您規劃停車場停車位置，<br>麻煩請先至座位查詢確認。</h1>

        <div id="parking-image-container">
          <img id="parking-image" alt="空白圖片" style="cursor: pointer;">
          <a href="https://reurl.cc/zpanl6" target="_blank">
            <div class="parking-img-P1 parking-marker P1"><img id="parking-home" src="./images/P1_0.png" alt="空白圖片">
            </div>
          </a>
          <a href="https://reurl.cc/748zkD" target="_blank">
            <div class="parking-img-P2 parking-marker P2"><img id="parking-home" src="./images/P2_0.png" alt="空白圖片">
            </div>
          </a>
          <a href="https://reurl.cc/lNWKrA" target="_blank">
            <div class="parking-img-P3 parking-marker P3"><img id="parking-home" src="./images/P3_0.png" alt="空白圖片">
            </div>
          </a>
          <a href="https://reurl.cc/04qM9b" target="_blank">
            <div class="parking-img-P4 parking-marker P4"><img id="parking-home" src="./images/P4_0.png" alt="空白圖片">
            </div>
          </a>
          <a href="https://reurl.cc/geAXrp" target="_blank">
            <div class="parking-img-P5 parking-marker P5"><img id="parking-home" src="./images/P5_0.png" alt="空白圖片">
            </div>
          </a>
          <a href="https://reurl.cc/46zVj2" target="_blank">
            <div class="parking-img-P6 parking-marker P6"><img id="parking-home" src="./images/P6_0.png" alt="空白圖片">
            </div>
          </a>
          <a href="https://reurl.cc/46VbyR" target="_blank">
            <div class="parking-img-P7 parking-marker P7"><img id="mini" src="./images/P7_0.png" alt="空白圖片"></div>
          </a>
          <a href="https://reurl.cc/kMeKlL" target="_blank">
            <div class="home-marker"><img src="./images/phome.png" alt="空白圖片"></div>
          </a>
        </div>
        <h2 class="park-info">點擊以下圖示，即可連結導航</h2>

        <div class="parking-info-text">
          <div class="parking-img-home">
            <a href="https://reurl.cc/kMeKlL" target="_blank"><img id="parking-h" src="./images/h.jpg" alt="空白圖片"
                style="width: 300px; height: 37px;"></a>
          </div>
          <div class="parking-img-P1">
            <a href="https://reurl.cc/zpanl6" target="_blank"><img id="parking-p1" src="./images/p1.jpg" alt="空白圖片"
                style="width: 300px; height: 37px;"></a>
          </div>
          <div class="parking-img-P2">
            <a href="https://reurl.cc/748zkD" target="_blank"><img id="parking-p2" src="./images/p2.jpg" alt="空白圖片"
                style="width: 300px; height: 37px;"></a>
          </div>
          <div class="parking-img-P3">
            <a href="https://reurl.cc/lNWKrA" target="_blank"><img id="parking-p3" src="./images/p3.jpg" alt="空白圖片"
                style="width: 300px; height: 37px;"></a>
          </div>
          <div class="parking-img-P4">
            <a href="https://reurl.cc/04qM9b" target="_blank"><img id="parking-p4" src="./images/p4.jpg" alt="空白圖片"
                style="width: 300px; height: 37px;"></a>
          </div>
          <div class="parking-img-P5">
            <a href="https://reurl.cc/geAXrp" target="_blank"><img id="parking-p5" src="./images/p5.jpg" alt="空白圖片"
                style="width: 300px; height: 37px;"></a>
          </div>
          <div class="parking-img-P6">
            <a href="https://reurl.cc/46zVj2" target="_blank"><img id="parking-p6" src="./images/p6.jpg" alt="空白圖片"
                style="width: 300px; height: 37px;"></a>
          </div>
          <div class="parking-img-P7">
            <a href="https://reurl.cc/46VbyR" target="_blank"><img id="parking-p7" src="./images/p7.jpg" alt="空白圖片"
                style="width: 300px; height: 37px;"></a>
          </div>

        </div>
      </div>
    </section>

  </main>

  <footer>
    <div class="footer-container">
      <!-- 左側圖片區 -->
      <div class="footer-images">
        <a href="https://www.greaten.com.tw/" target="_blank">
          <img id="footer-logo-geatens" alt="Logo 1">
        </a>
      </div>

      <!-- 聯絡資訊區 -->
      <div class="footer-contact">
        <div style="margin: auto;">
          <div class="contact-item ">
            <i class="bi bi-telephone-fill"></i>
            <span><b>電話：</b>(06) 5990703</span>
          </div>

          <div class="contact-item ">
            <i class="bi bi-geo-alt-fill "></i>
            <span><b>地址：</b>744002台南市新市區中山路131號</span>
          </div>

          <div class="contact-item">
            <i class="bi bi-envelope-fill"></i>
            <span><b>信箱：</b>greatenconst@greaten.com.tw</span>
          </div>

        </div>

      </div>
    </div>
    <div class="copyright">
      <!-- 版權資訊 -->
      <div>Copyright &copy; 2025 桂田集團 All Rights Reserved.<a href="javascript:void(0);" id="metavision-link">Design by
          Metavision</a> </div>
    </div>
    <div class="footer-container-mvd">
      <!-- 左側圖片區 -->
      <div class="footer-images-mvd">
        <img id="mvdlogo-1" alt="Logo 1" class="footer-logo">
        <img id="mvdlogoe" alt="Logo 2" class="footer-logo">
      </div>

      <!-- 聯絡資訊區 -->
      <div class="footer-contact">
        <div class="contact-item-mvd desktop-text">
          <i class="bi bi-telephone-fill"></i>
          <span><b>電話：</b>(06) 2793725</span>
        </div>
        <div class="contact-item-mvd mobile-text">
          <i class="bi bi-telephone-fill"></i>
          <span style="font-size: 12px;"><b>電話：</b><br>(06) 2793725</span>
        </div>
        <div class="contact-item-mvd desktop-text">
          <i class="bi bi-geo-alt-fill "></i>
          <span><b>地址：</b>台南市東區東門路三段253號10樓之1</span>
        </div>
        <div class="contact-item-mvd mobile-text">
          <i class="bi bi-geo-alt-fill "></i>
          <span style="font-size: 12px;"><b>地址：</b><br>台南市東區東門路三段253號10樓之1</span>
        </div>
        <div class="contact-item-mvd desktop-text">
          <i class="bi bi-envelope-fill"></i>
          <span><b>信箱：</b>mvd.sales@metavision.tw</span>
        </div>
        <div class="contact-item-mvd mobile-text">
          <i class="bi bi-envelope-fill"></i>
          <span style="font-size: 12px;"><b>信箱：</b><br>mvd.sales@metavision.tw</span>
        </div>

      </div>
    </div>
  </footer>

  <!-- 彈出視窗 -->
  <div id="imageModal" class="modal">
    <img class="modal-content" id="modalImage">
  </div>

  <script>
    document.getElementById("metavision-link").addEventListener("click", function () {
      const footerSection = document.querySelector(".footer-container-mvd");

      if (footerSection) {
        // 顯示 .footer-container-mvd
        footerSection.style.display = "flex";

        // 滾動至 .footer-container-mvd
        const headerHeight = document.querySelector("header")?.offsetHeight || 0; // 取得 header 高度，若不存在則為 0
        const elementPosition = footerSection.getBoundingClientRect().top + window.pageYOffset;

        window.scrollTo({
          top: elementPosition - headerHeight,
          behavior: "smooth"
        });
      }
    });

    window.addEventListener('load', function () {
      const loadingElement = document.getElementById('loading');
      const minLoadingTime = 0; // 最小加載時間（毫秒）
      const startTime = performance.now();

      function hideLoading() {
        const elapsedTime = performance.now() - startTime;
        const remainingTime = minLoadingTime - elapsedTime;
        if (remainingTime > 0) {
          setTimeout(() => {
            loadingElement.classList.add('hide-loading');
          }, remainingTime);
        } else {
          loadingElement.classList.add('hide-loading');
        }
      }

      hideLoading();
    });

    let nameCoordinates = {};
    // 從 GitHub 讀取座標資料
    $.ajax({
      url: 'https://raw.githubusercontent.com/mason099203/0331/main/src/json/0224.json',
      method: 'GET',
      success: function (response) {
        try {
          nameCoordinates = JSON.parse(response);
          // console.log('成功載入座標數據:', nameCoordinates);
        } catch (e) {
          console.error('解析數據失敗:', e);
        }
      },
      error: function (xhr, status, error) {
        console.error('讀取座標資料失敗:', error);
      }
    });

    // $.getJSON('./json/0224.json', function(response) {
    //   nameCoordinates = response;
    //   // console.log('成功載入座標數據:', response);
    // }).fail(function(jqxhr, textStatus, error) {
    //   // console.error('讀取座標資料失敗:', error);
    // });

    $(document).ready(function () {
      function searchAction() {
        for (let i = 1; i <= 7; i++) {
          $(`.parking-img-P${i}`).css('display', 'none');
        }
        let area_c = ['A', 'B', 'C', 'D', 'E'];
        for (let i = 0; i < area_c.length; i++) {
          $(`.area-${area_c[i]}`).css('display', 'none');
        }
        const inputValue = $('#nameInput').val().trim();
        const searchResult = $('#search-result');

        // 先清空之前的結果
        searchResult.empty();
        let park_link = { 'P1': "https://reurl.cc/zpanl6", 'P2': "https://reurl.cc/748zkD", 'P3': "https://reurl.cc/lNWKrA", 'P4': "https://reurl.cc/04qM9b", 'P5': "https://reurl.cc/geAXrp", 'P6': "https://reurl.cc/46zVj2", 'P7': "https://reurl.cc/46VbyR" };
        let groupedData_name = {};

        Object.values(nameCoordinates).forEach(item => {
          let prefix_name = item.name;
          if (prefix_name === inputValue && inputValue !== '') {
            if (!groupedData_name[prefix_name]) {
              groupedData_name[prefix_name] = []; // 初始化為陣列
            }
            groupedData_name[prefix_name].push(item); // 正確推入資料
          }
        });

        const foundperson = Object.values(groupedData_name).find(group =>
          group.some(item => item.name.toString().slice(0, inputValue.length) === inputValue)
        );

        let groupedData = {};
        Object.values(nameCoordinates).forEach(item => {
          if (item.company.includes(inputValue) && inputValue !== '') { // 檢查是否包含關鍵字
            if (!groupedData[inputValue]) {
              groupedData[inputValue] = []; // 初始化為陣列
            }
            groupedData[inputValue].push(item); // 推入符合條件的項目
          }
        });

        // 找到包含 inputValue 的公司資料
        const foundcompany = Object.values(groupedData).find(group =>
          group.some(item => item.company.includes(inputValue))
        );

        if (Object.keys(groupedData_name).length > 0) {
          let resultHtml = `
            <table border="1">
              <tr>
                <th>姓名</th>
                <th>公司名稱</th>
                <th>人數</th>
                <th>區域</th>
                <th>桌位圖</th>
                <th>停車場</th>
              </tr>`;

          $('.parking-marker').removeClass('highlight');
          // 遍歷 groupedData 並建立表格內容
          Object.values(groupedData_name).forEach(companyList => {
            companyList.forEach((foundperson, index) => {
              $(`.parking-img-${foundperson.park}`).css('display', 'block');
              $(`.area-${foundperson.area}`).css('display', 'block');
              resultHtml += `
                <tr class="animated-row" style="animation-delay: ${index * 0.1}s">
                  <td><p id="companyName">${foundperson.name.charAt(0)}<i class="bi bi-circle big-icon" ></i>${foundperson.name.charAt(foundperson.name.length - 1)}</p></td>
                  <td class="company-name">${foundperson.company}</td>
                  <td>${foundperson.number}</td>
                  <td>${foundperson.area}</td>
                  <td>${foundperson.table}</td>
                  <td onclick="scrollToSection('parking-info-section')"><img class="parkintable" src="./images/${foundperson.park}_0.png" alt="空白圖片"  ></i>
</td>
                </tr>`;
              // &nbsp;<i class="bi bi-geo-alt-fill" style="color:red">
            });
          });

          resultHtml += `</table>`;
          searchResult.html(resultHtml);
        } else if (Object.keys(groupedData).length > 0) { // 確保 groupedData 有內容
          let resultHtml = `
            <table border="1">
              <tr>
                <th>姓名</th>
                <th>公司名稱</th>
                <th>人數</th>
                <th>區域</th>
                <th>桌位圖</th>
                <th>停車場</th>
              </tr>`;

          // $('.parking-marker').removeClass('highlight');
          // 遍歷 groupedData 並建立表格內容
          Object.values(groupedData).forEach(companyList => {
            companyList.forEach((foundcompany, index) => {
              $(`.parking-img-${foundcompany.park}`).css('display', 'block'); //連結
              $(`.area-${foundcompany.area}`).css('display', 'block');

              resultHtml += `
                <tr class="animated-row" style="animation-delay: ${index * 0.1}s">
                  <td style="min-width:40px"><p id="companyName">${foundcompany.name.charAt(0)}<i class="bi bi-circle big-icon"></i>${foundcompany.name.charAt(foundcompany.name.length - 1)}</p></td>
                  <td class="company-name">${foundcompany.company}</td>
                  <td>${foundcompany.number}</td>
                  <td>${foundcompany.area}</td>
                  <td>${foundcompany.table}</td>
                  <td onclick="scrollToSection('parking-info-section')"><img class="parkintable" src="./images/${foundcompany.park}_0.png" alt="空白圖片"></i></td>
                </tr>`;
            });
          });
          resultHtml += `</table>`;
          searchResult.html(resultHtml);
        } else {
          alert('查無此編號的桌位。');
          searchResult.empty();
          // 清除所有高亮顯示
          $('.parking-marker').removeClass('highlight');
        }
        // 清空輸入框
        $('#nameInput').val('');
      }
      $('.search-icon').click(searchAction);

      $('#nameInput').keydown(function (event) {
        if (event.key === 'Enter') {
          event.preventDefault(); // 防止表單自動提交
          searchAction(); // 呼叫相同的搜尋函數
        }
      });
    });

    // 新增滾動功能
    function scrollToSection(sectionClass) {
      const section = document.querySelector('.' + sectionClass);
      const headerHeight = document.querySelector('header').offsetHeight;
      const elementPosition = section.getBoundingClientRect().top + window.pageYOffset;

      window.scrollTo({
        top: elementPosition - headerHeight,
        behavior: 'smooth'
      });
    }

    // 圖片彈出功能
    const parkingImage = document.getElementById('parking-image');
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImage');

    parkingImage.onclick = function () {

      modal.style.display = "block";
      modalImg.src = "./images/park_v1.webp";
      // this.src = "./images/park_v1.webp";
    }



    modal.onclick = function () {
      modal.style.display = "none";
    }

    // 檢查快取中是否有圖片
    function loadCachedImage(imgElement, src) {
      const img = new Image();
      img.onload = function () {
        imgElement.src = src;
      };
      img.src = src;
    }

    // 設置圖片 src
    const footerLogo = document.getElementById('footer-logo');
    loadCachedImage(footerLogo, './images/logo_footer.webp');
    const footerLogo_greatens = document.getElementById('footer-logo-geatens');
    loadCachedImage(footerLogo_greatens, './images/logo_footer.webp');
    const footerLogo2 = document.getElementById('footer-logo2');
    loadCachedImage(footerLogo2, './images/logo_footer2.png');
    const resultwithcircles = document.getElementById('result_with_circles');
    loadCachedImage(resultwithcircles, './images/20250226table.jpg');
    const parkingimage = document.getElementById('parking-image');
    loadCachedImage(parkingimage, './images/park_v1.png');
    const mvdlogo1 = document.getElementById('mvdlogo-1');
    loadCachedImage(mvdlogo1, './images/mvdlogo.webp');
    const mvdlogoe = document.getElementById('mvdlogoe');
    loadCachedImage(mvdlogoe, './images/mvdlogo_P.webp');


  </script>
</body>

</html>